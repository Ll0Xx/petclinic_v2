<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>My Account</title>
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.1.3/css/bootstrap.min.css} "/>

<body>
<header th:replace="_fragments.html :: header"></header>
<div class="col-10 mx-auto" id="issuesTable">
    <div>
        <div id="issuesTableContainer" th:classappend="${issuesList.isEmpty()} ? 'd-none' : ''">
            <div class="text-center my-3">
                <span> List of issues, click the button to add more </span>
                <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#issueModal">
                    Add issue
                </button>
            </div>
            <table id="issueTable" class="table table-striped">
                <thead>
                <tr class="fw-bold">
                    <td>Id</td>
                    <td>Doctor</td>
                    <td>Doctor specialization</td>
                    <td>Pet name</td>
                    <td>Issue description</td>
                    <td></td>
                </tr>
                </thead>
                <tbody>
                <tr th:each="issue: ${issuesList}">
                    <td th:text="${issue.id}"></td>
                    <td class="issue-doctor" th:text="${issue.doctor.user.email}"></td>
                    <td class="issue-doctorSpecialization" th:text="${issue.doctor.doctorSpecialization.name}"></td>
                    <td class="issue-pet" th:text="${issue.pet.name}"></td>
                    <td class="issue-description" th:text="${issue.description}"></td>
                    <td>
                        <button type="button" class="btn btn-primary" th:attr="data-bs-id=${issue.id}, data-bs-pet=${issue.pet.id}, data-bs-doctor=${issue.doctor.id}, data-bs-description=${issue.description}"
                                data-bs-toggle="modal" data-bs-target="#issueModal">
                            Edit
                        </button>
                        <button type="button" class="btn btn-danger" th:attr="data-bs-id=${issue.id}"
                                th:onclick="|deleteIssue('${issue.id}')|">
                            Delete
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div id="issuesListEmptyContainer" th:classappend="${!issuesList.isEmpty()} ? 'd-none' : ''">
        <div class="text-center mt-5">
            Issues history is empty.
        </div>
        <div class="d-grid gap-2 mt-3">
            <button type="button" class="btn btn-primary mb-3 mx-auto" data-bs-toggle="modal"
                    data-bs-target="#issueModal">
                Add new issue
            </button>
        </div>
    </div>
</div>

<th:block th:replace="_issue-modal :: modal('issueModal')">modal</th:block>


<script th:src="@{/webjars/jquery/3.6.0/jquery.min.js}"></script>
<script th:src="@{/webjars/popper.js/2.9.3/umd/popper.min.js}"></script>
<script th:src="@{/webjars/bootstrap/5.1.3/js/bootstrap.min.js}"></script>
<script th:src="@{/assets/issue-modal.js}"></script>


</body>
</html>
